package fr.epita.quizmanager.services.business;

import java.util.ArrayList;
import java.util.List;

import javax.inject.Inject;
import javax.transaction.Transactional;
import javax.transaction.Transactional.TxType;

import fr.epita.quizmanager.datamodel.Answer;
import fr.epita.quizmanager.datamodel.Question;
import fr.epita.quizmanager.datamodel.User;
import fr.epita.quizmanager.services.dao.AnswerDAO;
import fr.epita.quizmanager.services.dao.QuestionDAO;
import fr.epita.quizmanager.services.dao.UserDAO;

public class ExamDataService {
	
	@Inject
	UserDAO userDAO;

	@Inject
	QuestionDAO questionDAO;

	@Inject
	AnswerDAO answerDAO;

//	@Transactional(value = TxType.REQUIRED)
	public void saveAnswer(Question question, Answer answer) throws Exception {
		if (question.getId() != null) {
			if (questionDAO.getById(question.getId()) != null) {
				if (answer.getId() == null) {
					answerDAO.create(answer);
				}
				List<Answer> answers = new ArrayList<Answer>();
				if (question.getAnswers() != null) {
					answers = question.getAnswers();
					answers.add(answer);
				} else {
					answers.add(answer);
				}
				question.setAnswers(answers);
				questionDAO.update(question);
			} else {
				throw new NullPointerException("Question is not found.");
			}
		} else {
			throw new NullPointerException("Question is not found.");
		}
	}
	
	public void answerToQuestion(User user, Question question, Answer answer) {
		
	};

}
